 -- SITE PARA PEGAR AS INFORMAÇÕES: https://fiis.com.br/ OU https://www.fundsexplorer.com.br/ranking

INSERT INTO ADMINISTRADORES (NOME, TELEFONE, EMAIL,URL_SITE, CNPJ)
WITH DATA_ADMINISTRADORES AS (

    SELECT 'BTG PACTUAL SERVIÇOS FINANCEIROS S/A DTVM', '551133833102', 'ri.fundoslistados@btgpactual.com', 'www.btgpactual.com', '59281253000123' FROM DUAL UNION ALL
    SELECT 'PLANNER CORRETORA DE VALORES SA', '1121722667', 'inforegulatorio@planner.com.br', 'www.planner.com.br','00806535000154' FROM DUAL UNION ALL
    SELECT 'RJI CORRETORA DE TÍTULOS E VALORES MOBILIÁRIOS LTDA', '213500450021','backoffice.adm@rjicv.com.br','www.rjicv.com.br','42066258000130' FROM DUAL UNION ALL
    SELECT 'OLIVEIRA TRUST DTVM S.A.', '2135140000', 'ger2.fundos@oliveiratrust.com.br','www.oliveiratrust.com.br','36113876000191' FROM DUAL 
    )
    SELECT * FROM DATA_ADMINISTRADORES;
    
     
    INSERT INTO FUNDOS (TICKER, TIPO_ABBIMA, SEGMENTO, CONTA_EMIT, NUM_COTAS, 
    RAZAO_SOCIAL, CNPJ, NOME_PREGAO, PRAZO_DURACAO, TIPO_GESTAO, CNPJ_ADMIN)
    WITH DATA_FUNDOS AS (

    SELECT 'AAZQ11','Tílos e Valores Mobiliarios','Indefinido','24037284','18095', 'AZ QUEST SOLE FDO DE INV','44625826000111','FIAGRO AAZQ',
    'Indeterminado','ativa','59281253000123'FROM DUAL UNION ALL
    
    SELECT 'ABCP11','Renda','Shoppings','4709082','17747','Grand Plaza Shopping','01201140000190','Grand Plaza Shopping',
    'Indeterminado','Passiva','00806535000154'FROM DUAL UNION ALL
    
    SELECT  'AFHI11','Tílos e Valores Mobiliarios','Papel','3343095','23891','AF INVEST CRI','36642293000158','FII AFHI CRI','Indeterminado',
    'Ativa','42066258000130' FROM DUAL UNION ALL
    
    SELECT  'AIEC11','Renda','Lajes Corporativas','4824987','15564','AUTONOMY EDIF̓IOS CORPORATIVOS','35765826000126','FII AUTONOMY',
    'Indeterminado','Ativa','36113876000191' FROM DUAL
    )
    SELECT * FROM DATA_FUNDOS;
    
    commit
    
    select * from fundos;
    
    
INSERT INTO COTACOES (TICKER, DATA_COTA, COTA_ATUAL, REDIMENTO_ATUAL, MINIMO_COTA, 
MAXIMO_COTA, ABERTURA, FECHAMENTO, VOLUME_COTAS, MES)
WITH DATA_COTACOES AS (

    SELECT  'AAZQ11', TO_DATE('04/10/2023', 'DD-MM-YYYY'), '9.32', '0.12', '9.23', '9.44', '9.38', '9.40', '24037284', TO_DATE('09', 'MM') FROM DUAL UNION ALL
    SELECT  'ABCP11', TO_DATE('04/10/2023', 'DD-MM-YYYY'), '66.90', '0.60', '66.81', '71.22', '71.22', '67.24', '4709082', TO_DATE('09', 'MM') FROM DUAL UNION ALL
    SELECT  'AFHI11', TO_DATE('04/10/2023', 'DD-MM-YYYY'), '95.70', '1.05', '98.23', '96.18', '97.87', '98.23', '3343095', TO_DATE('09', 'MM') FROM DUAL UNION ALL
    SELECT  'AIEC11', TO_DATE('04/10/2023', 'DD-MM-YYYY'), '63.16', '0.76', '65.04', '69.79', '68.17', '65.69', '4824987', TO_DATE('09', 'MM') FROM DUAL 
    )
    )
    SELECT * FROM DATA_COTACOES;


INSERT INTO DIVIDENDOS (TICKER, DATA_COTA, COTA_ATUAL, ULT_DIVID, DY_ULT, 
DIV_ACAO, DIV_YIELD)
WITH DATA_DIVIDENDOS AS (

    SELECT  FROM DUAL UNION ALL
    SELECT  FROM DUAL UNION ALL
    SELECT  FROM DUAL UNION ALL
    SELECT  FROM DUAL UNION ALL
    SELECT  FROM DUAL UNION ALL
    SELECT  FROM DUAL UNION ALL
    SELECT  FROM DUAL UNION ALL
    SELECT  FROM DUAL UNION ALL

    SELECT  FROM DUAL 
    )
    SELECT * FROM DATA_DIVIDENDOS;
    
    
    
    
select  FUN.TICKER, FUN.TIPO_ABBIMA, FUN.SEGMENTO, ADM.CNPJ, ADM.NOME
from FUNDOS fun
join Administradores ADM on ADM.CNPJ = FUN.CNPJ_ADMIN
where FUN.TICKER !=''
    GROUP BY FUN.CNPJ_ADMIN
